<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">
  <title>My Media Tape</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">My Media Tape</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><%= link_to "Home", root_path %></li>
      </ul>

      <ul class="nav navbar-nav navbar-right">

           <li class="divider-vertical"></li>
            <% if user_signed_in? %>
	            <li class="dropdown">
	              <a class="dropdown-toggle" href="" data-toggle="dropdown"> <% if user_signed_in? %> <%= image_tag current_user.avatar.url(:thumb), style: "height:20px; padding-right:6px; border-radius:10px;" %> <%= " #{current_user.first_name}" %> <%= " #{ current_user.last_name}" %><% end %> <span class="badge"></span> <strong class="caret"></strong></a>
	              <div class="dropdown-menu" style=" padding:15px; padding-bottom: 10px;">
	                <ul class=" nav-pills nav-stacked nav-drop">
	                  	<li role="presentation" ><%= link_to "Home", root_path %></li>
						</li>
						<hr>
						<% if current_user.bands.any? %>
							<% current_user.bands.each do |band|%>
								<li role="presentation">
									<%= link_to band do %>
										<%= band.group_name %>
									<% end %>
								</li>
							<% end %>
						<% end %>
	                </ul>
	                <br/>
	                <%= link_to "Log Out", destroy_user_session_path, method: :delete, class: "btn btn-large btn-block btn-primary" %>
	              </div>
	            </li>
            <% else %>
	            <li>
		            <%= link_to "Sign Up", new_user_registration_path %>
		        </li>
		        <li>
		            <%= link_to "Sign In", :user_session %>
		        </li>
            <% end %>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<div class="container" style="margin-bottom: 100px;" data-pjax-container >
  <%= yield %>
</div>
<div class="media-player" >
<% if session[:song_id].present? %>
<% current_song = Song.find_by_id(session[:song_id]) %>
<% current_album = Album.find_by_id(session[:album_id]) %>
<% current_band = Band.find_by_id(session[:band_id]) %>
  <div class="audio-player" style="width: 100%; height: 84px;" width="100%">
    <div class="audio-info">
      <div class="audio-art">
        <%= image_tag current_song.album.album_art.url(:medium), class: "album-art", style: " object-fit:cover;" %>
      </div>
      <div class="audio-desc">

        <span class="artist"> <%= current_song.title %></span><br/>
        <span class="song"> <%= current_band.group_name %></span><br/>
        <span class="album"><%= current_album.name %></span><br/>
      </div>
        <audio src="<%= current_song.audio_file.url %>" id="audio-player" autoplay="true"></audio>
    </div>
  </div>
  <!-- <div class="audio-info">
    <div class="audio-art">
      <%= image_tag current_song.album.album_art.url(:medium), class: "album-art", style: " object-fit:cover;" %>
    </div>
    <div class="audio-desc">

      <span class="artist"> <%= current_song.title %></span><br/>
      <span class="song"> <%= current_band.group_name %></span><br/>
      <span class="album"><%= current_album.name %></span><br/>
    </div>
  </div>

  <div class="audio-playback">
    <audio src="<%= current_song.audio_file.url %>" crossorigin="anonymous" id="audio" >audio element not supported</audio>

    <div class="btn-group audio-controls" role="group" aria-label="...">
      <button type="button" class="btn btn-default" id="play"><i class="fa fa-play"></i>
      </button>
      <button type="button" class="btn btn-default" id="pause"><i class="fa fa-pause"></i>
      </button>
    </div>
    <div id='progressOut'>
         <div id='progressIn'>
         </div>
    </div>
    <div id='time'>00:00</div>
  </div>  -->

</div>
<script>

$(function(){
  $('#audio-player').mediaelementplayer({
    alwaysShowControls: true,
    features: ['playpause','progress','volume'],
    audioVolume: 'horizontal',
    iPadUseNativeControls: true,
    iPhoneUseNativeControls: true,
    AndroidUseNativeControls: true,
    pauseOtherPlayers: true
    });
});
</script>
<% else %>
 <%= image_tag("logo.png", :alt => "My Media Tape", :class => "styleSmLogo ") %>

<% end %>
</body>
</html>
